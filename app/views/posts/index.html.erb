<div class="container">
  <div class="row">

    <!-- Search Form -->
    <div class="col-md-4">
      <%= search_form_for @q, html: { style: "margin-bottom: 20px;" }, persist_state: true do |f| %>
        <div class="form-group">
          <%= f.label :title_or_body_cont, "ш│кхХПцдЬч┤в:" %>
          <%= f.search_field :title_or_body_cont, class: "form-control" %>
          <div class="form-group text-right">
            <%= f.submit "цдЬч┤в", class: "btn custom-search-button mt-2" %>
          </div>
        </div>
      <% end %>
    </div>

    <!-- Sorting Links -->
    <div class="col-md-4 d-flex flex-column align-items-end justify-content-center">
      <div class="mb-3">
        <%= link_to "хЫЮчнФцХ░уБМхдЪуБДщаЖуБлф╕жуБ╣цЫ┐уБИуВЛ", posts_path(q: { title_cont: params.dig(:q, :title_cont) }, order_by: 'responses_count'), class: "custom-sort-button" %>
      </div>
      <div>
        <%= link_to "цКХчи┐цЧещаЖуБлф╕жуБ╣цЫ┐уБИуВЛ", posts_path(q: { s: 'created_at desc' }), class: "custom-sort-button" %>
      </div>
    </div>

    <!-- Posts List -->
    <div class="col-md-8">
      <h5>ш│кхХПцКХчи┐ф╕Ашжз</h5>

      <% if @posts.empty? %>
        <div class="alert alert-info">
          <p>цКХчи┐уБпуБ╛уБауБВуВКуБ╛уБЫуВУуАВцЦ░уБЧуБПцКХчи┐уБЧуБжуБ┐уБ╛уБЫуВУуБЛя╝Я</p>
        </div>
      <% else %>
        <% @posts.each_with_index do |post, index| %>
          <div class="card mb-3">
            <div class="card-header small d-flex justify-content-between">
              <span>ш│кхХП<%= sprintf("%04d", post.id) %></span>
              <span>цКХчи┐шАЕхРН: <%= post.user.nickname if post&.user %></span>
              <span>цКХчи┐цЧецЩВ: <%= l(post.created_at, format: :long) if post.created_at.present? %></span>
            </div>
            <div class="card-body">
              <%= link_to post_path(post), class: "text-decoration-none text-dark" do %>
                <h6 class="card-title" style="border-bottom: 1px solid rgba(255, 145, 145, 0.5);"><%= post.title %></h6>
                <p class="card-text"><%= post.body %></p>
              <% end %>
            </div>
            <div class="card-footer text-muted small d-flex justify-content-between">
              <div>
                <% if user_signed_in? %>
                  <span id="like-button-<%= post.id %>">
                    <% post_like = post.post_likes.find { |like| like.user_id == current_user.id } %>
                    <% if post_like.present? %>
                      <%= link_to 'уБДуБДуБнуВТуВнуГгуГ│уВ╗уГл', post_post_like_path(post_id: post.id, id: post_like.id), method: :delete, remote: true, class: 'btn custom-like-btn small-font' %>
                    <% else %>
                      <%= link_to 'тЭдя╕П уБДуБДуБн', post_post_likes_path(post_id: post.id), method: :post, remote: true, class: 'btn custom-like-btn small-font' %>
                    <% end %>
                  </span>
                  <span id="like-count-<%= post.id %>" class="ml-0"><%= post.post_likes.size %></span>
                <% end %>
              </div>
              <div>
                <% if current_user %>
                  <%= form_with(url: notifications_path, local: false, id: "notification-form", style: "display: none;") do |form| %>
                    <%= form.hidden_field :user_id, value: current_user.id %>
                    <%= form.hidden_field :post_id, id: "post-id-field" %>
                    <div id="comment-section" style="display: none;">
                      <%= form.text_area :comment, id: "comment" %>
                      <%= form.submit "щАЪчЯеуБЩуВЛ", class: "btn custom-notify-btn small-font", id: "submit-btn" %>
                    </div>
                  <% end %>
                  <button id="notify-admin-btn" class="btn custom-notify-btn small-font">ЁЯФФчобчРЖшАЕуБлщАЪчЯеуБЩуВЛ</button>
                <% end %>
              </div>
              <div>
                <% if current_user&.admin? %>
                  <%= link_to 'цКХчи┐уВТхЙКщЩдуБЩуВЛ', post_path(post), method: :delete, data: { confirm: 'цЬмх╜УуБлхЙКщЩдуБЧуБ╛уБЩуБЛя╝Я' }, class: "btn btn-danger small-font" %>
                <% end %>
                <div class="d-flex">
                  <% if current_user %>
                    <%= link_to 'хЫЮчнФуБЩуВЛ', new_post_response_path(post), class: "btn custom-answer-btn small-font align-items-center" %>
                  <% end %>
                  <span class="ml-2 align-items-center">хЫЮчнФцХ░: <%= post.responses.size %></span>
                </div>
              </div>
            </div>
          </div>
        <% end %>

        <!-- Pagination -->
        <div class="mt-4">
          <%= paginate @posts %>
        </div>
      <% end %>
    </div>

    <!-- Sidebar -->
    <div class="col-md-4">
      <h5>ф╕╗уБкчзБчлЛх░ПхнжцабуБо<br>хнжцабшкмцШОф╝ЪцГЕха▒уБоуГкуГ│уВп</h5>
      <ul style="font-size: 1em; list-style-type: none; padding-left: 0;">
        <li style="margin-bottom: 5px;"><a class="custom-link" href="http://www.yochisha.keio.ac.jp/orientation/" style="color: red;">цЕ╢цЗЙч╛йхб╛х╣╝чиЪшИО</a></li>
        <li style="margin-bottom: 5px;"><a class="custom-link" href="https://www.gakushuin.ac.jp/prim/admission/guidance.html" style="color: red;">хнжч┐ТщЩвхИЭчнЙчзС</a></li>
        <li style="margin-bottom: 5px;"><a class="custom-link" href="https://www.futabagakuen-jh.ed.jp/primary/admissions/session/" style="color: red;">щЫЩшСЙх░Пхнжцаб</a></li>
        <li style="margin-bottom: 5px;"><a class="custom-link" href="http://www.yokohama-e.keio.ac.jp/admission/index.html" style="color: red;">цЕ╢цЗЙч╛йхб╛цикц╡ЬхИЭчнЙщГи</a></li>
        <li style="margin-bottom: 5px;"><a class="custom-link" href="https://www.age.aoyama.ed.jp/admission/explanation.html" style="color: red;">щЭТх▒▒хнжщЩвхИЭчнЙщГи</a></li>
        <li style="margin-bottom: 5px;"><a class="custom-link" href="https://www.shirayuri-e.ed.jp/examinee/index.html" style="color: red;">чЩ╜чЩ╛хРИхнжхЬТх░Пхнжцаб</a></li>
        <li style="margin-bottom: 5px;"><a class="custom-link" href="https://www.gyosei-e.ed.jp/admissions/" style="color: red;">цЪБцШЯх░Пхнжцаб</a></li>
        <li style="margin-bottom: 5px;"><a class="custom-link" href="https://elementary.seikei.ac.jp/entranceguide/tabid/104/Default.aspx" style="color: red;">цИРш╣Кх░Пхнжцаб</a></li>
        <li style="margin-bottom: 5px;"><a class="custom-link" href="https://www.tky-sacred-heart.ed.jp/04_nyugaku.html" style="color: red;">шБЦх┐Гхе│хнРхнжщЩв хИЭчнЙчзС</a></li>
        <li style="margin-bottom: 5px;"><a class="custom-link" href="https://es.rikkyojogakuin.ac.jp/admission/guideline/" style="color: red;">члЛцХЩхе│хнжщЩвх░Пхнжцаб</a></li>
        <li style="margin-bottom: 5px;"><a class="custom-link" href="https://www.toyoeiwa.ac.jp/shogaku/exam/" style="color: red;">цЭ▒ц┤ЛшЛ▒хТМхе│хнжщЩвх░Пхнжцаб</a></li>
        <li style="margin-bottom: 5px;"><a class="custom-link" href="https://prim.rikkyo.ac.jp/entrance/openschool/guidance2023.html" style="color: red;">члЛцХЩх░Пхнжцаб</a></li>
        <li style="margin-bottom: 5px;"><a class="custom-link" href="https://www.wasedajg.ed.jp/elementary/exam-e/explain-e/" style="color: red;">цЧйчи▓чФ░хоЯценхнжцабхИЭчнЙщГи</a></li>
        <li style="margin-bottom: 5px;"><a class="custom-link" href="https://www.denenchofufutaba.ed.jp/elementary/admissions/setsumeikai.html" style="color: red;">чФ░хЬТшк┐х╕ГщЫЩшСЙхнжхЬТх░Пхнжцаб</a></li>
        <li style="margin-bottom: 5px;"><a class="custom-link" href="https://es.rikkyojogakuin.ac.jp/admission/guideline/" style="color: red;">члЛцХЩхе│хнжщЩвх░Пхнжцаб</a></li>
        <li style="margin-bottom: 5px;"><a class="custom-link" href="https://www.senzoku.ed.jp/enter.htm" style="color: red;">ц┤Чш╢│хнжхЬТх░Пхнжцаб</a></li>
        <li style="margin-bottom: 5px;"><a class="custom-link" href="https://www.seijogakuen.ed.jp/shoto/admissions/guide/" style="color: red;">цИРхЯОхнжхЬТхИЭчнЙхнжцаб</a></li>
        <li style="margin-bottom: 5px;"><a class="custom-link" href="https://tjk.jp/p/topics/category/admission/" style="color: red;">цЭ▒ф║мхе│хнжщдих░Пхнжцаб</a></li>
        <li style="margin-bottom: 5px;"><a class="custom-link" href="https://www.jwu.ac.jp/elm/exam/exam.html" style="color: red;">цЧецЬмхе│хнРхдзш▒КцШОх░Пхнжцаб</a></li>
        <li style="margin-bottom: 5px;"><a class="custom-link" href="https://www.kawamura.ac.jp/syougaku/exam/" style="color: red;">х╖ЭцЭСх░Пхнжцаб</a></li>
        <li style="margin-bottom: 5px;"><a class="custom-link" href="https://www.morimura.ed.jp/examination/index.html" style="color: red;">цгоцЭСхнжхЬТхИЭчнЙщГи</a></li>
        <li style="margin-bottom: 5px;"><a class="custom-link" href="https://shotouka.koen-ejh.ed.jp/public_events/" style="color: red;">хЕЙхбйхе│хнРхнжщЩвхИЭчнЙчзС</a></li>
        <li style="margin-bottom: 5px;"><a class="custom-link" href="https://es.swu.ac.jp/admission/" style="color: red;">цШнхТМхе│хнРхдзхнжщЩДх▒ЮцШнхТМх░Пхнжцаб</a></li>
        <li style="margin-bottom: 5px;"><a class="custom-link" href="https://syougakkou.shonan-shirayuri.ac.jp/" style="color: red;">ц╣ШхНЧчЩ╜чЩ╛хРИхнжхЬТх░Пхнжцаб</a></li>
        <li style="margin-bottom: 5px;"><a class="custom-link" href="https://www.meguroseibisho.ed.jp/" style="color: red;">чЫощ╗ТцШЯч╛Ох░Пхнжцаб</a></li>
        <li style="margin-bottom: 5px;"><a class="custom-link" href="https://www.inter-edu.com/forum/read.php?4,6556874" style="color: red;">цЭ▒ф║мш╛▓ценхдзхнжчи▓шК▒х░Пхнжцаб</a></li>
        <li style="margin-bottom: 5px;"><a class="custom-link" href="https://shogakko.toho.ac.jp/exam/briefing" style="color: red;">цбРцЬЛх░Пхнжцаб</a></li>
        <li style="margin-bottom: 5px;"><a class="custom-link" href="https://netty.lekumo.biz/seika_news/exam/" style="color: red;">ч▓╛шПпх░Пхнжцаб</a></li>
      </ul>
    </div>

  </div>
</div>